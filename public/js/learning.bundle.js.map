{"version":3,"sources":["webpack:///webpack/bootstrap 58c192b4edfbf3411555","webpack:///./utils/pubsub.js","webpack:///./learning/model.js","webpack:///./learning/scene.js","webpack:///./utils/ajax.js","webpack:///../sass/learning.scss","webpack:///./learning/components/action.js","webpack:///./learning/components/event.js","webpack:///./learning/components/state.js","webpack:///./learning.js"],"names":["pubsub","topics","subscribe","topic","listener","queue","index","push","remove","publish","info","length","items","forEach","item","Model","data","id","name","breakTime","steps","states","map","state","currentState","getState","timeout","subscribtion","find","intervals","Promise","resolve","i","then","makeBreak","handleEvent","handleNewState","catch","reject","setTimeout","event","eventStartTime","Date","now","timeSpent","nextStateId","handleInput","nextState","last","inactiveTime","getInactiveTime","getInactiveAction","clearTimeout","Scene","$modelName","$stateImg","$stateParams","$event","$responseBox","$toolsBox","model","setModelName","setState","textContent","tools","toolsFragment","document","createDocumentFragment","div","createElement","classList","add","label","setAttribute","tool","appendChild","toolNode","createToolNode","innerHTML","type","createRangeTool","createSwitchTool","spanMin","min","input","max","spanMax","img","params","paramsFragment","key","createParameterNode","value","keySpan","valueSpan","toolsData","inputs","querySelectorAll","dataset","parseInt","checked","Error","ajax","path","options","xhr","XMLHttpRequest","open","method","headers","setXHRHeaders","send","onreadystatechange","readyState","status","responseText","statusText","header","setRequestHeader","Action","toolId","minTime","maxTime","inactive","time","rightTime","rightData","Array","isArray","includesValue","borders","Event","description","actions","action","times","getAllActionTimes","Math","suitedActions","filter","isSuitable","State","scene","querySelector","loadModel","JSON","parse","response","toggleControlButtons","$startButton","disabled","$stopButton","$loadButton","$select","addEventListener","modelId","init","initTools","console","error","err","start","stop","$runButton","getToolsData","setEvent"],"mappings":"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","file":"learning.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 8);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 58c192b4edfbf3411555","const pubsub = (function() {\r\n\r\n  const topics = {};\r\n\r\n  return {\r\n    subscribe: function(topic, listener) {\r\n      if (!topics[topic]) topics[topic] = { queue: [] };\r\n\r\n      const index = topics[topic].queue.push(listener) - 1;\r\n\r\n      // function to delete topic\r\n      return {\r\n        remove: function() {\r\n          delete topics[topic].queue[index];\r\n        }\r\n      };\r\n    },\r\n\r\n    publish: function(topic, info) {\r\n      // no theme or no listeners\r\n      if (!topics[topic] || !topics[topic].queue.length) return;\r\n\r\n      const items = topics[topic].queue;\r\n      items.forEach(item => {\r\n        item(info || {});\r\n      });\r\n    }\r\n  };\r\n})();\r\n\r\nexport default pubsub;\r\n\n\n\n// WEBPACK FOOTER //\n// ./utils/pubsub.js","import State from './components/state';\r\nimport pubsub from '../utils/pubsub';\r\n\r\nclass Model {\r\n  constructor(data) {\r\n    this.id = data.id;\r\n    this.name = data.name;\r\n    this.breakTime = data.breakTime;\r\n    this.steps = data.steps;\r\n\r\n    this.states = data.states.map(state => new State(state));\r\n    this.currentState = this.getState(data.id);\r\n\r\n    this.timeout = null;\r\n    this.subscribtion = null;\r\n  }\r\n\r\n  getState(id) {\r\n    return this.states.find(state => state.id == id);\r\n  }\r\n\r\n  start() {\r\n    let intervals = Promise.resolve(); // init promise chain\r\n    for (let i = 0; i < this.steps; i++) {\r\n      intervals = intervals\r\n       .then(() => { return this.makeBreak() })\r\n       .then(() => { return this.handleEvent() })\r\n       .then(state => { this.handleNewState(state) })\r\n    }\r\n    intervals.catch(state => { pubsub.publish('new_state',  state) });\r\n  }\r\n\r\n  makeBreak() {\r\n    return new Promise((resolve, reject) => {\r\n      setTimeout(() => { resolve() }, this.breakTime);\r\n    });\r\n  }\r\n\r\n  handleEvent() {\r\n    const event = this.currentState.event;\r\n    const eventStartTime = Date.now();\r\n    return new Promise((resolve, reject) => {\r\n      // send data about new event to other modules\r\n      pubsub.publish('event', { event });\r\n\r\n      // listen to user action\r\n      // and if user input correct go to next state\r\n      this.subscribtion = pubsub.subscribe('user_input', data => {\r\n        const timeSpent = Date.now() - eventStartTime;\r\n        const nextStateId = event.handleInput(data, timeSpent);\r\n        const nextState = this.getState(nextStateId);\r\n        if (nextState) {\r\n          nextState.last ? reject(nextState) : resolve(nextState);\r\n        }\r\n      })\r\n\r\n      // handle inactive\r\n      const inactiveTime = event.getInactiveTime();\r\n      this.timeout = setTimeout(() => {\r\n        const nextStateId = event.getInactiveAction().nextState;\r\n        const nextState = this.getState(nextStateId);\r\n        nextState.last ? reject(nextState) : resolve(nextState);\r\n      }, inactiveTime);\r\n    })\r\n  }\r\n\r\n  handleNewState(state) {\r\n    this.currentState = state;\r\n    clearTimeout(this.timeout);\r\n    this.subscribtion.remove();\r\n    pubsub.publish('new_state', state);\r\n  }\r\n\r\n  // TODO\r\n  stop() {\r\n\r\n  }\r\n\r\n}\r\n\r\nexport default Model;\r\n\n\n\n// WEBPACK FOOTER //\n// ./learning/model.js","class Scene {\r\n  constructor($modelName, $stateImg, $stateParams, $event, $responseBox, $toolsBox) {\r\n    this.$modelName = $modelName;\r\n    this.$stateImg = $stateImg;\r\n    this.$stateParams = $stateParams;\r\n    this.$event = $event;\r\n    this.$responseBox = $responseBox;\r\n    this.$toolsBox = $toolsBox;\r\n  }\r\n\r\n  init(model) {\r\n    this.setModelName(model.name).setState(model.currentState);\r\n    return this;\r\n  }\r\n\r\n  /** Set actual node content */\r\n  setModelName(name) {\r\n    this.$modelName.textContent = name;\r\n    return this;\r\n  }\r\n\r\n  /** Creates input elements in 'tools' box */\r\n  initTools(tools) {\r\n    const toolsFragment = document.createDocumentFragment();\r\n\r\n    tools.forEach(tool => {\r\n      // Wrap every tool for proper display and add label\r\n      const div = document.createElement('div');\r\n      div.classList.add('tool');\r\n\r\n      const label = document.createElement('label');\r\n      label.setAttribute('for', tool.name);\r\n      label.textContent = tool.name;\r\n      div.appendChild(label);\r\n\r\n      const toolNode = this.createToolNode(tool);\r\n      div.appendChild(toolNode);\r\n\r\n      // Append to fragment\r\n      toolsFragment.appendChild(div);\r\n    });\r\n\r\n    this.$toolsBox.innerHTML = '';\r\n    this.$toolsBox.appendChild(toolsFragment);\r\n    return this;\r\n  }\r\n\r\n  createToolNode(tool) {\r\n    switch(tool.type) {\r\n      case 'range':\r\n        return this.createRangeTool(tool);\r\n      case 'switch':\r\n        return this.createSwitchTool(tool);\r\n      default:\r\n        return 'Unknown tool type';\r\n    }\r\n  }\r\n\r\n  createRangeTool(tool) {\r\n    const div = document.createElement('div');\r\n\r\n    const spanMin = document.createElement('span');\r\n    spanMin.textContent = tool.min;\r\n    div.appendChild(spanMin)\r\n\r\n    const input = document.createElement('input');\r\n    input.setAttribute('data-id', tool.id);\r\n    input.setAttribute('data-type', 'range');\r\n    input.setAttribute('name', tool.name);\r\n    input.setAttribute('type', 'range');\r\n    input.setAttribute('min', tool.min);\r\n    input.setAttribute('max', tool.max);\r\n    div.appendChild(input);\r\n\r\n    const spanMax = document.createElement('span');\r\n    spanMax.textContent = tool.max;\r\n    div.appendChild(spanMax);\r\n\r\n    return div;\r\n  }\r\n\r\n  createSwitchTool(tool) {\r\n    const label = document.createElement('label');\r\n    label.classList.add('switch');\r\n\r\n    const input = document.createElement('input');\r\n    input.setAttribute('data-id', tool.id);\r\n    input.setAttribute('data-type', 'switch');\r\n    input.setAttribute('type', 'checkbox');\r\n    label.appendChild(input);\r\n\r\n    const div = document.createElement('div');\r\n    div.classList.add('slider');\r\n    label.appendChild(div);\r\n\r\n    return label;\r\n  }\r\n\r\n  /** Sets img and parameters of current state to UI */\r\n  setState({ img, params }) {\r\n    // Change state image\r\n    this.$stateImg.setAttribute('src', img);\r\n\r\n    // Set state parameters\r\n    const paramsFragment = document.createDocumentFragment();\r\n    for (let key in params) {\r\n      paramsFragment.appendChild(this.createParameterNode(key, params[key]));\r\n    }\r\n    this.$stateParams.innerHTML = '';\r\n    this.$stateParams.appendChild(paramsFragment);\r\n\r\n    return this;\r\n  }\r\n\r\n  createParameterNode(key, value) {\r\n    const div = document.createElement('div');\r\n\r\n    const keySpan = document.createElement('span');\r\n    keySpan.textContent = key;\r\n    div.appendChild(keySpan);\r\n\r\n    const valueSpan = document.createElement('span');\r\n    valueSpan.textContent = value;\r\n    div.appendChild(valueSpan);\r\n\r\n    return div;\r\n  }\r\n\r\n  /** Sets event data to UI */\r\n  setEvent(event) {\r\n    this.$event.textContent = event.name;\r\n  }\r\n\r\n  /** Get data from tool nodes */\r\n  getToolsData() {\r\n    const toolsData = {};\r\n    const inputs = this.$toolsBox.querySelectorAll('input[data-id]');\r\n    inputs.forEach(input => {\r\n      const { id, type } = input.dataset;\r\n      let value;\r\n      switch(type) {\r\n        case 'range': value = parseInt(input.value); break;\r\n        case 'switch': value = input.checked; break;\r\n        default: throw new Error('Invalid tool type');\r\n      }\r\n      toolsData[id] = value;\r\n    });\r\n    return toolsData;\r\n  }\r\n}\r\n\r\nexport default Scene;\r\n\n\n\n// WEBPACK FOOTER //\n// ./learning/scene.js","function ajax(path = '', options = {}) {\r\n  const xhr = new XMLHttpRequest();\r\n  xhr.open(options.method || 'GET', path, true);\r\n  if (options.headers) { setXHRHeaders(xhr, options.headers); }\r\n  xhr.send(options.data);\r\n\r\n  return new Promise((resolve, reject) => {\r\n    xhr.onreadystatechange = function() {\r\n      if(xhr.readyState == 4) {\r\n        if(xhr.status == 200) {\r\n          resolve(xhr.responseText);\r\n        } else {\r\n          reject(xhr.statusText);\r\n        }\r\n      }\r\n    }\r\n  })\r\n}\r\n\r\nfunction setXHRHeaders(xhr, headers) {\r\n  for (let header in headers) {\r\n    xhr.setRequestHeader(header, headers[headers]);\r\n  }\r\n}\r\n\r\nexport default ajax;\r\n\n\n\n// WEBPACK FOOTER //\n// ./utils/ajax.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../sass/learning.scss\n// module id = 4\n// module chunks = 0","class Action {\r\n  constructor(data) {\r\n    this.toolId = data.tool;\r\n    this.minTime = data.minTime;\r\n    this.maxTime = data.maxTime;\r\n    this.nextState = data.nextState;\r\n    if (data.inactive) {\r\n      this.inactive = true;\r\n      this.value = null;\r\n    } else {\r\n      this.inactive = false;\r\n      this.value = data.value;\r\n    }\r\n\r\n  }\r\n\r\n  isSuitable(data, time) {\r\n    return this.rightTime(time) && this.rightData(data);\r\n  }\r\n\r\n  rightData(data) {\r\n    if (typeof this.value == 'boolean' && data[this.toolId] && data[this.toolId] == this.value) {\r\n      return true;\r\n    } else if (Array.isArray(this.value) && data[this.toolId] && this.includesValue(data[this.toolId])) {\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  includesValue(value, borders) {\r\n    return (value > this.value[0]) && (value < this.value[1]);\r\n  }\r\n\r\n  rightTime(time) {\r\n    return (time > this.minTime) && (time < this.maxTime);\r\n  }\r\n}\r\n\r\nexport default Action;\r\n\n\n\n// WEBPACK FOOTER //\n// ./learning/components/action.js","import Action from './action';\r\n\r\nclass Event {\r\n  constructor(data) {\r\n    this.id = data.id;\r\n    this.name = data.name;\r\n    this.description = data.description;\r\n    this.actions = data.actions.map(action => new Action(action));\r\n  }\r\n\r\n  getInactiveTime() {\r\n    const times = this.getAllActionTimes();\r\n    return Math.max(...times);\r\n  }\r\n\r\n  getInactiveAction() {\r\n    return this.actions.find(action => action.inactive === true);\r\n  }\r\n\r\n  getAllActionTimes() {\r\n    return this.actions.map(action => action.maxTime || 0);\r\n  }\r\n\r\n  handleInput(data, time) {\r\n    const suitedActions = this.actions.filter(action => action.isSuitable(data, time));\r\n    if (suitedActions) {\r\n      return suitedActions[0].nextState;\r\n    }\r\n  }\r\n}\r\n\r\nexport default Event;\r\n\n\n\n// WEBPACK FOOTER //\n// ./learning/components/event.js","import Event from './event' ;\r\n\r\nclass State {\r\n  constructor(data) {\r\n    this.id = data.id;\r\n    this.name = data.name;\r\n    this.img = data.img;\r\n    this.params = data.params;\r\n\r\n    if(data.last) {\r\n      this.last = true;\r\n      this.event = null;\r\n    } else {\r\n      this.event = new Event(data.event);\r\n      this.last = false;\r\n    }\r\n\r\n  }\r\n}\r\n\r\nexport default State;\r\n\n\n\n// WEBPACK FOOTER //\n// ./learning/components/state.js","import '../sass/learning.scss';\r\n\r\nimport pubsub from './utils/pubsub';\r\nimport ajax from './utils/ajax';\r\nimport Scene from './learning/scene';\r\nimport Model from './learning/model';\r\n\r\nconst scene = new Scene(\r\n  document.querySelector('.model-name'),\r\n  document.querySelector('.state-visual'),\r\n  document.querySelector('.state-params'),\r\n  document.querySelector('.event'),\r\n  document.querySelector('.response'),\r\n  document.querySelector('.tools')\r\n)\r\n\r\n/**\r\n * Load model with given id\r\n */\r\nfunction loadModel(id) {\r\n  return ajax(`/models/${id}`).then(response => JSON.parse(response));\r\n}\r\n\r\nfunction toggleControlButtons() {\r\n  $startButton.disabled = !$startButton.disabled;\r\n  $stopButton.disabled = !$stopButton.disabled;\r\n}\r\n\r\n/**\r\n * UI button's handlers\r\n */\r\nconst $loadButton = document.querySelector('#load-model-btn');\r\nconst $select = document.querySelector(\"#model-select\");\r\nlet model = {};\r\n$loadButton.addEventListener('click', () => {\r\n  const modelId = $select.value;\r\n  loadModel(modelId)\r\n    .then(response => {\r\n      model = new Model(response);\r\n      scene.init(model).initTools(response.tools);\r\n      toggleControlButtons();\r\n    })\r\n    .catch(err => { console.error(err) });\r\n});\r\n\r\nconst $startButton = document.querySelector('#start-btn');\r\n$startButton.addEventListener('click', () => {\r\n  model.start();\r\n});\r\n\r\nconst $stopButton = document.querySelector('#stop-btn');\r\n$stopButton.addEventListener('click', () => {\r\n  model.stop(); // TODO\r\n});\r\n\r\nconst $runButton = document.querySelector('#run-btn');\r\n$runButton.addEventListener('click', () => {\r\n  const toolsData = scene.getToolsData();\r\n  pubsub.publish('user_input', toolsData);\r\n});\r\n\r\n/**\r\n * Handle custom events here (user input, programm messages etc.)\r\n */\r\npubsub.subscribe('new_state', state => scene.setState(state));\r\npubsub.subscribe('event', data => scene.setEvent(data.event));\r\n\n\n\n// WEBPACK FOOTER //\n// ./learning.js"],"sourceRoot":""}