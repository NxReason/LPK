{"version":3,"file":"learning.bundle.js","sources":["webpack:///learning.bundle.js"],"sourcesContent":["!function(t){function e(a){if(n[a])return n[a].exports;var i=n[a]={i:a,l:!1,exports:{}};return t[a].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,a){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:a})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,\"a\",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p=\"\",e(e.s=21)}([function(t,e,n){\"use strict\";function a(t,e){var n=e.classList;n&&n.forEach&&n.forEach(function(e){return t.classList.add(e)})}function i(t,e){var n=e.attrs;if(n){var a=Object.keys(n);a.forEach(function(e){return t.setAttribute(e,n[e])})}}function u(t,e){var n=e.textContent,a=void 0===n?\"\":n;t.textContent=a}Object.defineProperty(e,\"__esModule\",{value:!0});var r=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:\"div\",e=arguments[1],n=document.createElement(t);return a(n,e),i(n,e),u(n,e),n};e.default=r},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var a=function(){var t={};return{subscribe:function(e,n){t[e]||(t[e]={queue:[]});var a=t[e].queue.push(n)-1;return{remove:function(){delete t[e].queue[a]}}},publish:function(e,n){if(t[e]&&t[e].queue.length){var a=t[e].queue;a.forEach(function(t){t(n||{})})}}}}();e.default=a},,function(t,e,n){\"use strict\";function a(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}Object.defineProperty(e,\"__esModule\",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,\"value\"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),r=n(14),o=a(r),s=n(1),l=a(s),c=\"Состояние модели\",d=\"Обучение остановлено\",f=function(){function t(e){i(this,t),this.id=e.id,this.name=e.name,this.breakTime=e.breakTime,this.steps=e.steps,this.states=e.states.map(function(t){return new o.default(t)}),this.initialState=e.initialState,this.currentState=this.getState(this.initialState),this.timeout=null,this.subInput=null,this.subStop=null,this.startState=new o.default({id:0,name:c,img:\"img/start.png\",last:!0}),this.stopState=new o.default({id:-1,name:d,img:\"img/stop.png\",last:!0})}return u(t,[{key:\"getState\",value:function(t){return this.states.find(function(e){return e.id==t})}},{key:\"start\",value:function(){var t=this;this.currentState=this.getState(this.initialState),l.default.publish(\"new_state\",this.currentState);for(var e=Promise.resolve(),n=0;n<this.steps;n++)e=e.then(function(){return t.makeBreak()}).then(function(){return t.handleEvent()}).then(function(e){t.handleNewState(e)});return e.catch(function(e){return t.handleNewState(e)}),e}},{key:\"makeBreak\",value:function(){var t=this;return new Promise(function(e,n){t.subStop=l.default.subscribe(\"model_stop\",function(){n(t.stopState)}),setTimeout(function(){t.clearSubs(),e()},t.breakTime)})}},{key:\"handleEvent\",value:function(){var t=this,e=this.currentState.event,n=Date.now();return new Promise(function(a,i){l.default.publish(\"event\",e),t.subInput=l.default.subscribe(\"user_input\",function(e){var u=Date.now()-n,r=t.currentState.handleInput(e,u),o=t.getState(r);o&&(o.last?i(o):a(o))}),t.subStop=l.default.subscribe(\"model_stop\",function(){i(t.stopState)});var u=t.currentState.getInactiveTime();t.timeout=setTimeout(function(){var e=t.currentState.getInactiveAction().nextState,n=t.getState(e);n.last?i(n):a(n)},u)})}},{key:\"stop\",value:function(){l.default.publish(\"model_stop\")}},{key:\"handleNewState\",value:function(t){this.currentState=t,clearTimeout(this.timeout),this.clearSubs(),l.default.publish(\"new_state\",t)}},{key:\"clearSubs\",value:function(){this.subInput&&this.subInput.remove(),this.subStop&&this.subStop.remove()}}]),t}();e.default=f},function(t,e,n){\"use strict\";function a(t){return t&&t.__esModule?t:{default:t}}function i(t){f.style.display=t}function u(t,e){t.forEach(function(t){return t.disabled=e})}Object.defineProperty(e,\"__esModule\",{value:!0});var r=n(15),o=a(r),s=n(16),l=a(s),c={},d=document.querySelector(\".model-name\");c.init=function(t,e){return d.textContent=t.name,o.default.set(t.startState),l.default.init(e.tools),this};var f=document.querySelector(\".content\");c.showContent=function(){return i(\"flex\"),this},c.hideContent=function(){return i(\"none\"),this},c.enableButtons=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return u(e,!1),this},c.disableButtons=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return u(e,!0),this},c.getToolsData=function(){return l.default.getToolsData()},c.setState=function(t){return o.default.set(t)},c.showEvent=function(t){return o.default.showEvent(t)},c.hideEvent=function(){return o.default.hideEvent()},e.default=c},function(t,e,n){\"use strict\";function a(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:\"\",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new XMLHttpRequest;return n.open(e.method||\"GET\",t,!0),e.headers&&i(n,e.headers),n.send(e.data),new Promise(function(t,e){n.onreadystatechange=function(){4==n.readyState&&(200==n.status?t(n.responseText):e(n.statusText))}})}function i(t,e){for(var n in e)t.setRequestHeader(n,e[e])}Object.defineProperty(e,\"__esModule\",{value:!0}),e.default=a},,,function(t,e){},,,,function(t,e,n){\"use strict\";function a(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}Object.defineProperty(e,\"__esModule\",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,\"value\"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),u=function(){function t(e){a(this,t),this.minTime=e.minTime,this.maxTime=e.maxTime,this.nextState=e.nextState,e.inactive?(this.inactive=!0,this.tools=[]):(this.inactive=!1,this.tools=this.initTools(e.tools))}return i(t,[{key:\"isSuitable\",value:function(t,e){return this.rightTime(e)&&this.rightData(t)}},{key:\"rightData\",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return this.tools.every(function(n){var a=e.find(function(t){return t.id==n.id});return!!a&&(\"switch\"===n.type?a.value===n.boolValue:\"range\"===n.type&&t.includesValue(a.value,[n.minValue,n.maxValue]))})}},{key:\"includesValue\",value:function(t,e){if(\"number\"!=typeof t)throw new TypeError(\"Value should be integer\");return t>=e[0]&&t<=e[1]}},{key:\"rightTime\",value:function(t){if(\"number\"!=typeof t)throw new TypeError(\"Time should be integer (ms)\");return t>=this.minTime&&t<=this.maxTime}},{key:\"initTools\",value:function(t){return t.map(function(t){return{id:t.id,type:t.type,minValue:t.ActionTool.minValue,maxValue:t.ActionTool.maxValue,boolValue:t.ActionTool.boolValue}})}}]),t}();e.default=u},function(t,e,n){\"use strict\";function a(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}Object.defineProperty(e,\"__esModule\",{value:!0});var i=function t(e){a(this,t),this.id=e.id,this.name=e.name,this.description=e.description};e.default=i},function(t,e,n){\"use strict\";function a(t){return t&&t.__esModule?t:{default:t}}function i(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function u(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}Object.defineProperty(e,\"__esModule\",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,\"value\"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),o=n(13),s=a(o),l=n(12),c=a(l),d=function(){function t(e){u(this,t),this.id=e.id,this.name=e.name,this.img=e.img,this.params=e.params,e.last?(this.last=!0,this.event=null,this.actions=null):(this.event=new s.default(e.event),this.actions=e.actions.map(function(t){return new c.default(t)}),this.last=!1)}return r(t,[{key:\"getInactiveTime\",value:function(){var t=this.getAllActionTimes();return Math.max.apply(Math,i(t))}},{key:\"getInactiveAction\",value:function(){return this.actions.find(function(t){return t.inactive===!0})}},{key:\"getAllActionTimes\",value:function(){return this.actions.map(function(t){return t.maxTime||0})}},{key:\"handleInput\",value:function(t,e){var n=this.actions.filter(function(n){return n.isSuitable(t,e)});return n.length>0?n[0].nextState:null}}]),t}();e.default=d},function(t,e,n){\"use strict\";function a(t){return t&&t.__esModule?t:{default:t}}function i(t){var e=t.name,n=t.img,a=t.params;p.textContent=e,m.setAttribute(\"src\",n),u(a)}function u(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=document.createDocumentFragment();t.forEach(function(t){return e.appendChild(r(t.name,t.value))}),b.innerHTML=\"\",b.appendChild(e)}function r(t,e){var n=(0,f.default)(\"div\",{classList:[\"parameter\"]}),a=(0,f.default)(\"span\",{textContent:t});n.appendChild(a);var i=(0,f.default)(\"span\",{textContent:e});return n.appendChild(i),n}function o(t){S.textContent=t.name,g.textContent=t.description,y.classList.remove(\"is-hidden\",\"slide-top\"),l()}function s(){y.classList.add(\"is-hidden\",\"slide-top\"),c()}function l(){w.classList.remove(\"is-hidden\"),v.default.start()}function c(){w.classList.add(\"is-hidden\"),v.default.stop()}Object.defineProperty(e,\"__esModule\",{value:!0});var d=n(0),f=a(d),h=n(18),v=a(h),p=document.querySelector(\".model-state-name\"),m=document.querySelector(\".model-state-img\"),b=document.querySelector(\".model-params-values\"),y=document.querySelector(\".model-event\"),S=y.querySelector(\".model-event-name span\"),g=y.querySelector(\".model-event-info\"),w=document.querySelector(\".model-timer\");w.appendChild(v.default.node),e.default={set:i,showEvent:o,hideEvent:s}},function(t,e,n){\"use strict\";function a(t){return t&&t.__esModule?t:{default:t}}function i(t){var e=document.createDocumentFragment();t.forEach(function(t){var n=(0,c.default)(\"div\",{classList:[\"tool\"]}),a=(0,c.default)(\"label\",{classList:[\"tool-name\"],attrs:{for:t.name},textContent:t.name});n.appendChild(a);var i=u(t);n.appendChild(i),e.appendChild(n)}),f.innerHTML=\"\",f.appendChild(e)}function u(t){switch(t.type){case d.RANGE:return r(t);case d.SWITCH:return o(t);default:return\"Неизвестный прибор\"}}function r(t){var e=(0,c.default)(\"div\",{classList:[\"range\"]}),n=(0,c.default)(\"span\",{textContent:t.min});e.appendChild(n);var a=(0,c.default)(\"input\",{attrs:{\"data-id\":t.id,\"data-type\":\"range\",name:t.name,type:\"range\",min:t.min,max:t.max}});e.appendChild(a);var i=(0,c.default)(\"span\",{textContent:t.max});e.appendChild(i);var u=(0,c.default)(\"div\",{classList:[\"range-current-value\"]}),r=(0,c.default)(\"span\",{textContent:a.value});u.appendChild(r),a.addEventListener(\"input\",function(t){r.textContent=t.target.value});var o=document.createDocumentFragment();return o.appendChild(e),o.appendChild(u),o}function o(t){var e=(0,c.default)(\"label\",{classList:[\"switch\"]}),n=(0,c.default)(\"input\",{attrs:{\"data-id\":t.id,\"data-type\":\"switch\",type:\"checkbox\"}});e.appendChild(n);var a=(0,c.default)(\"div\",{classList:[\"slider\"]});return e.appendChild(a),e}function s(){var t=[],e=f.querySelectorAll(\"input[data-id]\");return e.forEach(function(e){var n=e.dataset,a=n.id,i=n.type,u=void 0;switch(i){case d.RANGE:u=parseInt(e.value);break;case d.SWITCH:u=e.checked;break;default:throw new Error(\"Некорректный тип прибора. ID: \"+a)}t.push({id:a,value:u})}),t}Object.defineProperty(e,\"__esModule\",{value:!0});var l=n(0),c=a(l),d={RANGE:\"range\",SWITCH:\"switch\"},f=document.querySelector(\".tools-list\");e.default={init:i,getToolsData:s}},,function(t,e,n){\"use strict\";function a(t){return t&&t.__esModule?t:{default:t}}function i(t){var e=Math.round(t/1e3),n=Math.floor(e/60),a=e-60*n;return n+\":\"+(a>=10?\"\":\"0\")+a}Object.defineProperty(e,\"__esModule\",{value:!0});var u=n(0),r=a(u),o={startTime:null,interval:null,node:(0,r.default)(\"span\",{classList:[\"timer\"],textContent:\"0:00\"}),start:function(){var t=this;this.startTime=Date.now(),this.interval=setInterval(function(){var e=Date.now()-t.startTime;t.node.textContent=i(e)},1e3)},stop:function(){this.startTime&&(this.startTime=null,clearInterval(this.interval),this.node.textContent=\"0:00\")}};e.default=o},,,function(t,e,n){\"use strict\";function a(t){return t&&t.__esModule?t:{default:t}}function i(t){return(0,s.default)(\"/models/\"+t).then(function(t){return JSON.parse(t)})}n(8);var u=n(1),r=a(u),o=n(5),s=a(o),l=n(4),c=a(l),d=n(3),f=a(d),h=document.querySelector(\"#model-select\"),v=document.querySelector(\"#load-model-btn\"),p=null;v.addEventListener(\"click\",function(){p&&p.stop();var t=h.value;i(t).then(function(t){p=new f.default(t),c.default.init(p,t).showContent().enableButtons(m).disableButtons(b,y)}).catch(function(t){console.error(t)})});var m=document.querySelector(\"#start-btn\");m.addEventListener(\"click\",function(){p.start(),c.default.disableButtons(m),c.default.enableButtons(b,y)});var b=document.querySelector(\"#stop-btn\");b.addEventListener(\"click\",function(){p.stop(),c.default.enableButtons(m),c.default.disableButtons(b,y)});var y=document.querySelector(\"#run-btn\");y.addEventListener(\"click\",function(){var t=c.default.getToolsData();r.default.publish(\"user_input\",t)}),r.default.subscribe(\"new_state\",function(t){c.default.hideEvent(),c.default.setState(t)}),r.default.subscribe(\"event\",function(t){return c.default.showEvent(t)})}]);\n\n\n// WEBPACK FOOTER //\n// learning.bundle.js"],"mappings":"AAAA","sourceRoot":""}